
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Setting Up Watchguard Device to Report to NSTI 3.0.2, Guided Instructions: &mdash; NSTI 3.0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.2.0/spacelab/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '3.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="NSTI 3.0.2 documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          NSTI</a>
        <span class="navbar-text navbar-version pull-left"><b>3.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizer.html">SNMP Trap Data Visualizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="backendaccess.html">NSTI Backend</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Setting Up Watchguard Device to Report to NSTI 3.0.2, Guided Instructions:</a><ul>
<li><a class="reference internal" href="#configure-snmptt">1. Configure SNMPTT</a></li>
<li><a class="reference internal" href="#make-sure-snmptt-is-set-to-always-start-on-boot-up">2. Make Sure SNMPTT is set to Always Start on Boot Up</a></li>
<li><a class="reference internal" href="#update-snmptrapd-and-snmptrapd-conf-to-handle-traps-and-execute-known-oids">3. Update snmptrapd and snmptrapd.conf to handle traps and execute known OIDs</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/snmpttsetup.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="setting-up-watchguard-device-to-report-to-nsti-3-0-2-guided-instructions">
<h1>Setting Up Watchguard Device to Report to NSTI 3.0.2, Guided Instructions:<a class="headerlink" href="#setting-up-watchguard-device-to-report-to-nsti-3-0-2-guided-instructions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configure-snmptt">
<h2>1. Configure SNMPTT<a class="headerlink" href="#configure-snmptt" title="Permalink to this headline">¶</a></h2>
<p>Open /etc/snmp/snmptt.ini and change the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">unknown_trap_log_enable</span> <span class="o">=</span> 1

<span class="nv">description_mode</span> <span class="o">=</span> 1

<span class="nv">unknown_trap_exec</span> <span class="o">=</span> /etc/snmp/traphandle.sh

<span class="nv">snmptt_conf_files</span> <span class="o">=</span> <span class="s">&lt;&lt;END</span>
<span class="s">/etc/snmp/watchguard.conf</span>
<span class="s">/etc/snmp/snmptt.conf</span>
<span class="s">END</span>
</pre></div>
</div>
<p>Now we can create the script we refer to above to handle the MIBS we want to translate.  Here&#8217;s the list we will use for this example:</p>
<ul class="simple">
<li>IPSEC-ISAKMP-IKE-DOI-TC</li>
<li>WATCHGUARD-CLIENT-MIB</li>
<li>WATCHGUARD-INFO-SYSTEM-MIB</li>
<li>WATCHGUARD-IPSEC-ENDPOINT-PAIR-MIB</li>
<li>WATCHGUARD-IPSEC-SA-MON-MIB-EXT</li>
<li>WATCHGUARD-IPSEC-TUNNEL-MIB</li>
<li>WATCHGUARD-POLICY-MIB</li>
<li>WATCHGUARD-PRODUCTS-MIB</li>
<li>WATCHGUARD-SMI</li>
<li>WATCHGUARD-SYSTEM-CONFIG-MIB</li>
<li>WATCHGUARD-SYSTEM-STATISTICS-MIB</li>
</ul>
<p>Remember to do your research to be sure that you have all of the dependancy MIBS, some of them may not actually be in your mibs directory by deafult and will cause errors.  For our example I already added my WatchGuard dependancy MIBs to the  /usr/share/snmp/mibs  directory (some of the are in the directory by default):</p>
<ul class="simple">
<li>IF-MIB</li>
<li>IP-MIB</li>
<li>RFC1155 SMI-MIB</li>
<li>RFC1213-MIB</li>
<li>SNMPv2-MIB</li>
<li>SNMPv2-SMI</li>
<li>TCP-MIB</li>
<li>UDP-MIB</li>
</ul>
<p>Here is our custom script that will read our watchguard specific files, or you can use a wildcard to select all MIBS in the directory,</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>i in WATCHGUARD* IPSEC*; <span class="k">do</span>
<span class="k">        </span>snmpttconvertmib --in<span class="o">=</span>/usr/share/snmp/mibs/<span class="nv">$i</span> --out<span class="o">=</span>/etc/snmp/watchguard.conf --exec<span class="o">=</span><span class="s1">&#39;/etc/snmp/traphandle.sh $r $s &quot;$D&quot;&#39;</span>
<span class="k">done</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Here we create a new .conf file so we can differentiate between our different types of MIBs.  You have to add these files to be read by snmptt.ini like we have set in the first part of this section.  Also, the * will read EVERY mib file in the given directory so make sure that you want to execute and create an in and out of the MIB files you have stored there.  We use a glob for WATCHGUARD* and IPSEC* for this example since the names aren&#8217;t all the same.</p>
</div>
</div>
<div class="section" id="make-sure-snmptt-is-set-to-always-start-on-boot-up">
<h2>2. Make Sure SNMPTT is set to Always Start on Boot Up<a class="headerlink" href="#make-sure-snmptt-is-set-to-always-start-on-boot-up" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>chkconfig &#8211;list</li>
</ul>
<p>Run this command to ensure snmptt exists, if  use</p>
<ul class="simple">
<li>not chkconfig &#8211;add snmptt)</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre>chkconfig --level 2345 snmptt on

service snmptt start
</pre></div>
</div>
</div>
<div class="section" id="update-snmptrapd-and-snmptrapd-conf-to-handle-traps-and-execute-known-oids">
<h2>3. Update snmptrapd and snmptrapd.conf to handle traps and execute known OIDs<a class="headerlink" href="#update-snmptrapd-and-snmptrapd-conf-to-handle-traps-and-execute-known-oids" title="Permalink to this headline">¶</a></h2>
<ol class="loweralpha simple">
<li>In /etc/init.d/snmptrapd:</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">&quot;-On -s -u /var/run/snmptrapd.pid&quot;</span>
</pre></div>
</div>
<ol class="loweralpha simple" start="2">
<li>Open snmptrapd.conf and add:</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre>disableAuthorization yes  <span class="o">(</span>use this in your initial setup to ensure everything is working.  Remove this later <span class="k">for </span>security<span class="o">)</span>
traphandle default /usr/local/sbin/snmptt
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014, Nagios Enterprises LLC, Luke Groschen, Nicholas Scott.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>